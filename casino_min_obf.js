function Game(){this.stoppedRunning=false;this.mX=0;this.mY=0;this.cursorMode="move";this.mO=0;this.pause=false;this.selectedGame=0;this.bgC=document.getElementById("bgC");this.bgCxt=this.bgC.getContext("2d");this.mgC=document.getElementById("mgC");this.mgCxt=this.mgC.getContext("2d");this.fgC=document.getElementById("fgC");this.fgCxt=this.fgC.getContext("2d");this.personInfo=document.getElementById("personInfo");this.casinoGameInfo=document.getElementById("gameInfo");this.casinoInfo=document.getElementById("casinoInfo");var e=new Array;e["slots"]=100;e["blackjack"]=250;e["craps"]=500;e["roulette"]=150;var t=0;this.attendance=0;this.amountOfDoodads=0;this.plp=new Array(r);this.cash=1e3;this.popularity=50;this.cG=new Array(100);this.doodads=new Array(1e3);this.init=function(){for(var e=0;e<r;e++){if(this.attendance<q){this.plp[e]=new Person;this.plp[e].init(doorX,doorY,this.fgC,this.fgCxt);this.attendance++}else{this.plp[e]=0}}for(var e=0;e<MaxSlots;e++){this.cG[e]=0}for(var e=0;e<1e3;e++){this.doodads[e]=0}};this.update=function(){t++;if(this.popularity>100){this.popularity=100}else if(this.popularity<0){this.popularity=0}if(this.pause==false){for(var e=0;e<r;e++){if(this.plp[e]!=0){this.plp[e].update()}if(this.plp[e].gone==true){delete this.plp[e];this.plp[e]=0;this.attendance--}}for(var e=0;e<MaxSlots;e++){if(this.cG[e]!=0){this.cG[e].update()}}}if(t%300==0){var n=Math.random()*100;if(this.popularity>n){for(var e=0;e<r;e++){if(this.plp[e]==0){this.plp[e]=new Person;this.plp[e].init(doorX,doorY,this.fgC,this.fgCxt);this.attendance++;break}}}}document.getElementById("casinoCash").innerHTML="$"+this.cash;document.getElementById("casinoAttendance").innerHTML=this.attendance;document.getElementById("casinoPopularity").innerHTML=this.popularity+"%"};this.draw=function(){this.fgCxt.clearRect(0,0,640,480);for(var e=0;e<r;e++){if(this.plp[e]!=0){this.plp[e].draw()}}this.fgCxt.drawImage(j,doorX,doorY);if(this.cursorMode=="move"){this.fgCxt.drawImage(g,this.mX-16,this.mY-16)}else{this.fgCxt.drawImage(h,this.mX-16,this.mY-16)}if(this.cursorMode=="move"){this.mgCxt.clearRect(0,0,640,480)}for(var e=0;e<MaxSlots;e++){if(this.cG[e]!=0){this.cG[e].draw()}}this.bgCxt.fillRect(0,0,640,480);this.bgCxt.fillStyle=floorPattern;for(var e=0;e<1e3;e++){if(this.doodads[e]!=0){this.doodads[e].draw()}}if(this.cash<=0){this.fgCxt.font="30px Arial";this.fgCxt.fillStyle="#0026FF";this.fgCxt.fillText("You have gone bankrupt!  Refresh to play again!",0,240);this.pause=true}};this.run=function(){this.update();this.draw()};this.mouseClicked=function(e){if(this.cursorMode=="select"){var t=true;for(var n=0;n<MaxSlots;n++){if(this.cG[n]!=0){if(this.cG[n].x<this.mX&&this.cG[n].x+this.cG[n].width>this.mX&&this.cG[n].y<this.mY&&this.cG[n].y+this.cG[n].height>this.mY){this.selectedGame=this.cG[n];this.cG[n].selected=true;t=false;document.getElementById("gameWinRate").value=this.cG[n].winRate;document.getElementById("gameCashOut").value=this.cG[n].cashOut;document.getElementById("gameCostToPlay").value=this.cG[n].costToPlay;document.getElementById("gameUpKeep").innerHTML="$"+this.cG[n].upKeep;document.getElementById("gameMaxPlayers").innerHTML=this.cG[n].maxPlayers;this.casinoInfo.style.display="none";this.casinoGameInfo.style.display="block";this.personInfo.style.display="none"}else{this.mgCxt.clearRect(0,0,640,480);this.cG[n].selected=false}}}if(t==true){for(var n=0;n<r;n++){if(this.plp[n]!=0){if(this.plp[n].x<this.mX&&this.plp[n].x+16>this.mX&&this.plp[n].y<this.mY&&this.plp[n].y+16>this.mY){this.plp[n].selected=true;t=false;document.getElementById("personMood").innerHTML=this.plp[n].mood+"%";document.getElementById("personCash").innerHTML="$"+this.plp[n].cash;document.getElementById("personThought").innerHTML=this.plp[n].thought;this.casinoInfo.style.display="none";this.casinoGameInfo.style.display="none";this.personInfo.style.display="block"}else{this.plp[n].selected=false}}}}if(t==true){this.casinoInfo.style.display="block";this.personInfo.style.display="none";this.casinoGameInfo.style.display="none"}}else if(this.cursorMode=="move"){if(this.mO==0){for(var n=0;n<1e3;n++){if(this.doodads[n]!=0){if(this.doodads[n].x<this.mX&&this.doodads[n].x+16>this.mX&&this.doodads[n].y<this.mY&&this.doodads[n].y+16>this.mY){this.doodads[n].selected=true;this.mO=this.doodads[n]}else{this.doodads[n].selected=false}}}for(var n=0;n<MaxSlots;n++){if(this.cG[n]!=0){if(this.cG[n].x<this.mX&&this.cG[n].x+this.cG[n].width>this.mX&&this.cG[n].y<this.mY&&this.cG[n].y+this.cG[n].height>this.mY){if(this.mO!=0){this.mO.selected=false}this.cG[n].selected=true;this.mO=this.cG[n];break}else{this.cG[n].selected=false}}}}else{this.mO.selected=false;this.mO=0}}};this.mouseReleased=function(e){if(this.cursorMode=="move"){}};this.mouseMoved=function(e){this.mX=e.pageX-this.fgC.offsetLeft;this.mY=e.pageY-this.fgC.offsetTop;if(this.cursorMode=="move"){if(this.mO!=0){this.mO.x=Math.round(this.mX/16)*16;this.mO.y=Math.round(this.mY/16)*16}}};this.pauseGame=function(){if(this.pause==true){this.pause=false}else{this.pause=true}};this.saveCasinoGame=function(){this.selectedGame.winRate=parseFloat(document.getElementById("gameWinRate").value);this.selectedGame.cashOut=parseFloat(document.getElementById("gameCashOut").value);this.selectedGame.costToPlay=parseFloat(document.getElementById("gameCostToPlay").value)};this.addGame=function(t){if(game.cash>e[t]){var n=true;for(var r=0;r<MaxSlots;r++){if(this.cG[r]==0){this.cG[r]=new CasinoGame;this.cG[r].setType(t);this.cursorMode="move";this.mO=this.cG[r];this.cG[r].init(0,0,this.mgC,this.mgCxt);game.cash-=e[t];n=false;break}}if(n==true){alert("You have maxed out the number of games you can own.")}}else{alert("If you buy anymore games you will go bankrupt.")}};this.addDoodad=function(e){if(game.cash>10){var t=true;for(var n=0;n<1e3;n++){if(this.doodads[n]==0){this.doodads[n]=new Doodad;this.doodads[n].frame=e;this.cursorMode="move";this.mO=this.doodads[n];this.doodads[n].init(0,0,this.mgC,this.mgCxt);game.cash-=10;t=false;this.amountOfDoodads++;this.popularity+=.5;break}}if(t==true){alert("You have maxed out the number of decorations you can own.")}}else{alert("If you buy anymore decorations you will go bankrupt.")}};this.changeCursorMode=function(e){this.cursorMode=e;this.mO.x=0;this.mO.y=0;this.mO=0;if(this.cursorMode=="move"){document.getElementById("move").className="buttonSelected";document.getElementById("select").className="button"}else{document.getElementById("select").className="buttonSelected";document.getElementById("move").className="button"}};fgC.addEventListener("mousedown",function(e){game.mouseClicked(e)},false);fgC.addEventListener("mouseup",function(e){game.mouseReleased(e)},false);fgC.addEventListener("mousemove",function(e){game.mouseMoved(e)},false)}function Entity(){this.x=0;this.y=0;this.canvas=0;this.context=0;this.init=function(e,t,n,r){this.x=e;this.y=t;this.canvas=n;this.context=r};this.update=function(){};this.draw=function(){}}function Person(){this.goalX=Math.floor(Math.random()*640);this.goalY=Math.floor(Math.random()*480);this.thought="wandering";this.cash=100;this.mood=100;this.gameImPlaying=0;this.imPlayerNumber=0;this.selected=false;this.gone=false;this.frame=0;this.ticks=0;this.update=function(){this.ticks++;switch(this.thought){case"wandering":if(this.closeToGoal()){this.goalX=Math.floor(Math.random()*640);this.goalY=Math.floor(Math.random()*480)}if(this.cash<=0||this.mood<=0){this.thought="leave"}if(this.ticks%30==0){this.mood--}if(this.ticks%120==0){this.thought="findGameToPlay"}this.move();break;case"findGameToPlay":for(var e=0;e<MaxSlots;e++){if(game.cG[e]!=0){if(game.cG[e].currentPlayers<game.cG[e].maxPlayers&&game.cG[e].costToPlay<this.cash&&game.cG[e]!=game.mO){this.gameImPlaying=game.cG[e];this.thought="moveToGame";break}}}if(this.gameImPlaying==0){this.thought="wandering";this.mood-=2}break;case"moveToGame":this.goalX=this.gameImPlaying.x;this.goalY=this.gameImPlaying.y;this.move();if(this.closeToGoal()){if(this.gameImPlaying.currentPlayers>=this.gameImPlaying.maxPlayers){this.gameImPlaying=0;this.thought="findGameToPlay";this.mood-=2}else{this.thought="playGame";this.imPlayerNumber=this.gameImPlaying.currentPlayers;this.gameImPlaying.currentPlayers++}}break;case"playGame":this.frame=1;if(this.goalX!=this.gameImPlaying.x||this.goalY!=this.gameImPlaying.y){this.gameImPlaying.currentPlayers--;this.gameImPlaying=0;this.thought="findGameToPlay";break}if(this.gameImPlaying.height>16){this.y=this.gameImPlaying.y+16;this.x=this.gameImPlaying.x+16*this.imPlayerNumber}if(this.cash<this.gameImPlaying.costToPlay){this.thought="wandering";this.gameImPlaying.currentPlayers-=1;this.gameImPlaying=0}if(this.ticks%60==0){this.cash-=this.gameImPlaying.costToPlay;game.cash+=this.gameImPlaying.costToPlay;if(this.gameImPlaying.didIWin()==true){this.cash+=this.gameImPlaying.cashOut;this.mood+=10;game.popularity++}else{this.mood--}}break;case"leave":if(this.closeToGoal()){if(this.mood<=30){game.popularity--}this.gone=true}this.goalX=doorX+16;this.goalY=doorY+16;this.move();break}};this.draw=function(){if(this.selected==true){this.context.fillStyle="#54FF29";this.context.fillRect(this.x-1,this.y-1,18,18)}this.context.drawImage(f,16*this.frame,0,16,16,this.x,this.y,16,16)};this.move=function(){if(this.x>this.goalX){this.x-=1;this.frame=2}else if(this.x<this.goalX){this.x+=1;this.frame=3}if(this.y>this.goalY){this.y-=1;this.frame=1}else if(this.y<this.goalY){this.y+=1;this.frame=0}};this.closeToGoal=function(){return Math.abs(this.x-this.goalX)<1&&Math.abs(this.y-this.goalY)<1}}function CasinoGame(){this.winRate=.5;this.cashOut=100;this.costToPlay=0;this.upKeep=0;this.maxPlayers=0;this.type="";this.width=16;this.height=16;this.frame=0;this.ticks=0;this.b=0;this.selected=false;this.currentPlayers=0;this.currentLoses=0;this.currentWins=0;this.setType=function(e){this.type=e;switch(e){case"slots":this.b=5;this.maxPlayers=1;this.upKeep=1;this.costToPlay=1;this.cashOut=10;this.winRate=.1;break;case"roulette":this.b=2;this.maxPlayers=5;this.width=32;this.height=32;this.upKeep=4.5;this.costToPlay=15;this.cashOut=20;this.winRate=.3;break;case"blackjack":this.b=2;this.maxPlayers=3;this.width=32;this.height=32;this.upKeep=2;this.costToPlay=15;this.cashOut=20;this.winRate=.3;break;case"craps":this.b=2;this.maxPlayers=6;this.width=32;this.height=32;this.upKeep=3;this.costToPlay=15;this.cashOut=20;this.winRate=.3;break}};this.update=function(){this.ticks++;if(this.ticks>60){this.frame++;this.ticks=0;game.cash+=this.currentLoses*this.costToPlay-this.currentWins*this.cashOut-this.upKeep;this.currentLoses=0;this.currentWins=0}if(this.frame>=this.b){this.frame=0}};this.draw=function(){if(this.selected==true){this.context.fillStyle="#54FF29";this.context.fillRect(this.x-1,this.y-1,this.width+2,this.height+2)}var e=0;switch(this.type){case"slots":e=l;break;case"roulette":e=m;break;case"blackjack":e=n;break;case"craps":e=o;break}this.context.drawImage(e,this.width*this.frame,0,this.width,this.height,this.x,this.y,this.width,this.height)};this.didIWin=function(){var e=Math.random();if(this.winRate<e){this.currentLoses++;return false}else{this.currentWins++;return true}}}function Doodad(){this.frame=0;this.selected=false;this.draw=function(){if(this.selected==true){this.context.fillStyle="#54FF29";this.context.fillRect(this.x-1,this.y-1,18,18)}this.context.drawImage(p,16*this.frame,0,16,16,this.x,this.y,16,16)}}function StartGame(){game.init();run()}function run(){e=Date.now();d=e-d;d=e;var t=document.getElementById("fps-text").innerHTML=a;game.run();if(game.stoppedRunning==false){requestAnimFrame(run)}b++;c+=d;if(c>1e3){c-=1e3;a=b;b=0}}var a=0;var b=0;var c=0;var d=Date.now();var e;var d;var f=new Image;f.src="Person.png";var g=new Image;g.src="cross.png";var h=new Image;h.src="magnifyingglass.png";var j=new Image;j.src="door.png";var k=new Image;k.src="floor.png";var floorPattern=0;k.onload=function(){var e=document.getElementById("bgC");var t=e.getContext("2d");floorPattern=t.createPattern(k,"repeat")};var l=new Image;l.src="SlotMachine.png";var m=new Image;m.src="roulettewheel.png";var n=new Image;n.src="blackjack.png";var o=new Image;o.src="craps.png";var p=new Image;p.src="doodads.png";var q=10;var r=1e3;var MaxSlots=100;var doorX=320;var doorY=448;Person.prototype=new Entity;CasinoGame.prototype=new Entity;Doodad.prototype=new Entity;var game=new Game;window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e,t){window.setTimeout(e,1e3/60)}}()